import pandas as pd
import numpy as np

# Data Visualization packages
import plotly.express as px
import plotly.graph_objects as go
from plotly.subplots import make_subplots
import matplotlib.pyplot as plt
import seaborn as sns

# Metrics
from sklearn.metrics import roc_auc_score, accuracy_score, f1_score, ConfusionMatrixDisplay, confusion_matrix, precision_score, recall_score


def display_confusion_matrix(vulnerability,test_target,predictions):
    """ Display a confustion matrix for a specific vulnerability """
    fig, ax = plt.subplots(figsize=(10, 10))
    title_font = {'size':'16'}  
    ax.set_title(f'{vulnerability} Confusion Matrix', fontdict=title_font);
    plt.xlabel('xlabel', fontsize=14)
    plt.ylabel('ylabel', fontsize=14)
    ConfusionMatrixDisplay.from_predictions(test_target,predictions,normalize='true',ax=ax,cmap="Purples")
    plt.show()
    return confusion_matrix(test_target,predictions)